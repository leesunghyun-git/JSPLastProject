<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sist.mapper.jjim-mapper">
	<!--  Jjim 확인 
			rno : 맛집번호 / 레시피번호 / 상품번호
			type : 1		  2		   3
			jno : 고유번호 : 취소
	
	-->
	<select id="jjimCheckCount" resultType="int" parameterType="jjimVO">
		SELECT COUNT(*)
		FROM all_jjim
		WHERE id=#{id} AND rno=#{rno} AND type=#{type}
	</select>
	<insert id="jjimInsert" parameterType="JjimVO">
		INSERT INTO all_jjim VALUES(
			aj_lno_seq.nextval,
			#{type},#{rno},#{id},SYSDATE
		)
	</insert>
	<resultMap type="jjimVO" id="jjimMap">
		<result property="fvo.name" column="name"/>
		<result property="fvo.poster" column="poster"/>
		<result property="fvo.fno" column="fno"/>
		<result property="fvo.address" column="address"/>
	</resultMap>
	<select id="jjimFoodListData" resultMap="jjimMap" parameterType="string">
		SELECT jno,aj.type,rno,name,poster,address,fno
		FROM all_jjim aj, menupan_food mf
		WHERE aj.rno=mf.fno
		AND id=#{id} AND aj.type=1
		ORDER BY jno DESC
	</select>
	<delete id="jjimCancel" parameterType="int">
		DELETE all_jjim
		WHERE jno=#{jno}
	</delete>
</mapper>